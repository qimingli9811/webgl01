<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WebGL Shape Switcher</title>
  <style>
    body {
      background-color: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      margin-top: 20px;
    }
	
	h1, h2 {
		display: inline-block;
		margin-right: 10px; /* Add some space between them */
	}

    .button-container {
      margin: 20px auto;
    }

    button {
      background-color: #3a8df0;
      color: white;
      font-size: 0.99em;
      border: none;
      border-radius: 6px;
      padding: 4px 15px;
      margin: 4px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }

    button:hover {
      background-color: #2b6fc2;
    }

    /* âœ… Highlighted / checked button */
    button.active {
      background-color: #00c853; /* green */
      transform: scale(1.05);
      box-shadow: 0 0 10px #00c853;
    }

    canvas {
      display: block;
      margin: 20px auto;
      border: 1px solid #444;
    }
	
	.topT {
	  background: linear-gradient(90deg, #006bff, #00c3ff);
	  color: white;
	  padding: 10px 0;
	  text-align: center;
	}

  </style>
</head>
<body>
  <section id="home" class="topT">
    <div class="container">
      <h1>WebGL Demo</h1>
		<h2 id="info">infoooo</h2>
    </div>
	
    <div class="button-container">
      <button class="myButton" id="triangleBtn" class="active">Triangle</button>
      <button class="myButton" id="squareBtn">Square</button>
      <button class="myButton" id="squareBtnA">SquareA</button>
      <button class="myButton" id="squareBtnB">SquareB</button>
    </div>
  </section>

  <canvas id="myGL" width="1280" height="480"></canvas>

  <script>
  
	function isAndroid() {
		const userAgent = navigator.userAgent || navigator.vendor || window.opera;
		return /android/i.test(userAgent);
	}
    var info = document.getElementById("info");
	if (isAndroid()) {
	    info.innerHTML = "(Android)";
	} else {
	    info.innerHTML = "(Not Android)";
	}

    // === WebGL Setup ===
    const canvas = document.getElementById("myGL");
	if(isAndroid())
	{
		canvas.width = 480;
		canvas.height = 640;
	}

    const gl = canvas.getContext("webgl");
    if (!gl) {
      alert("WebGL not supported");
      throw new Error("WebGL not supported");
    }
		
    // --- Shaders ---
    const vsSource = `
      attribute vec2 aPosition;
      attribute vec3 aColor;
      varying vec3 vColor;
      uniform float uAngle;
      void main() {
        float cosA = cos(uAngle);
        float sinA = sin(uAngle);
        mat2 rot = mat2(cosA, -sinA, sinA, cosA);
        gl_Position = vec4(rot * aPosition, 0.0, 1.0);
        vColor = aColor;
      }
    `;

    const fsSource = `
      precision mediump float;
      varying vec3 vColor;
      void main() {
        gl_FragColor = vec4(vColor, 1.0);
      }
    `;

    function compileShader(type, source) {
      const shader = gl.createShader(type);
      gl.shaderSource(shader, source);
      gl.compileShader(shader);
      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        console.error("Shader error:", gl.getShaderInfoLog(shader));
      }
      return shader;
    }

    const vs = compileShader(gl.VERTEX_SHADER, vsSource);
    const fs = compileShader(gl.FRAGMENT_SHADER, fsSource);

    const program = gl.createProgram();
    gl.attachShader(program, vs);
    gl.attachShader(program, fs);
    gl.linkProgram(program);
    gl.useProgram(program);

    const aPosition = gl.getAttribLocation(program, "aPosition");
    const aColor = gl.getAttribLocation(program, "aColor");
    const uAngle = gl.getUniformLocation(program, "uAngle");

    let buffer, vertices, vertexCount;
    let angle = 0;
    let currentShape = "Triangle";

    function loadShape(shape) {
      if (shape === "Triangle") {
        vertices = new Float32Array([
          0.0,  0.7,   1.0, 0.0, 0.0,
         -0.7, -0.7,   0.0, 1.0, 0.0,
          0.7, -0.7,   0.0, 0.0, 1.0
        ]);
        vertexCount = 3;
      } else if (shape === "Square") {
        vertices = new Float32Array([
          -0.5,  0.5,   1, 0, 0,
          -0.5, -0.5,   0, 1, 0,
           0.5,  0.5,   0, 0, 1,

           0.5,  0.5,   0, 0, 1,
          -0.5, -0.5,   0, 1, 0,
           0.5, -0.5,   1, 1, 0
        ]);
        vertexCount = 6;
      }

      buffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
      gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

      const FSIZE = vertices.BYTES_PER_ELEMENT;
      gl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, FSIZE * 5, 0);
      gl.enableVertexAttribArray(aPosition);
      gl.vertexAttribPointer(aColor, 3, gl.FLOAT, false, FSIZE * 5, FSIZE * 2);
      gl.enableVertexAttribArray(aColor);
    }

    // --- Button Controls ---
    const triangleBtn = document.getElementById("triangleBtn");
    const squareBtn = document.getElementById("squareBtn");

	let myButtonsArray = [];
	const buttonNodes = document.querySelectorAll('.myButton');
	myButtonsArray = Array.from(buttonNodes);
	//alert(myButtonsArray.length);

    function setActiveButton(activeBtn) {
		// Remove 'active' from all, then set the one clicked
		myButtonsArray.forEach(button => {
			button.classList.remove("active");
		});

      activeBtn.classList.add("active");
    }

	myButtonsArray.forEach(button => {
		button.addEventListener('click', () => {
		currentShape = button.textContent;
		loadShape(button.textContent);
		setActiveButton(button);
		console.log(`A button was clicked! Its text is: ${button.textContent}`);
		});
	});

/*
    triangleBtn.onclick = () => {
      currentShape = "triangle";
      loadShape("triangle");
      setActiveButton(triangleBtn);
    };

    squareBtn.onclick = () => {
      currentShape = "square";
      loadShape("square");
      setActiveButton(squareBtn);
    };

    squareBtnA.onclick = () => {
      currentShape = "square";
      loadShape("square");
      setActiveButton(squareBtnA);
    };

    squareBtnB.onclick = () => {
      currentShape = "square";
      loadShape("square");
      setActiveButton(squareBtnB);
    };
	*/

    // --- Initialize & Render ---
    loadShape("Triangle");

    function render() {
      angle += 0.02;
      gl.uniform1f(uAngle, angle);
      gl.clearColor(0.05, 0.05, 0.1, 1.0);
      gl.clear(gl.COLOR_BUFFER_BIT);
      gl.drawArrays(gl.TRIANGLES, 0, vertexCount);
      requestAnimationFrame(render);
    }
    render();
  </script>
</body>
</html>
